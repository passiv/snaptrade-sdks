# Getting Started

This is an interactive demo to help you get started with the SnapTrade API. You can run the code snippets directly in your browser to see the API in action. By the end of this demo, you will have created a new user, connected a brokerage account, and retrieved account details and positions. Let's get started!

## 1. Initialize a client with your clientId and consumerKey

You can get your SnapTrade `clientId` and `consumerKey` by [registering for a new account](https://dashboard.snaptrade.com/signup). Once you have your credentials, please enter them below to initialize the SnapTrade client. Please note that your `consumerKey` is sensitive information and should be kept secure at all times.

::::form

::input{name=SNAPTRADE_CLIENT_ID label="Client ID" placeholder="YOUR_CLIENT_ID"}

::input{name=SNAPTRADE_CONSUMER_KEY label="Consumer Key" placeholder="YOUR_CONSUMER_KEY" type="password"}

:::code

```python
import json
from snaptrade_client import SnapTrade
import uuid
import os

snaptrade = SnapTrade(
consumer_key=SNAPTRADE_CONSUMER_KEY,
client_id=SNAPTRADE_CLIENT_ID,
)

print("Successfully initiated client")
```

```typescript
import { Snaptrade } from "snaptrade-typescript-sdk";
const snaptrade = new Snaptrade({
  consumerKey: process.env.SNAPTRADE_CONSUMER_KEY,
  clientId: process.env.SNAPTRADE_CLIENT_ID,
});
console.log("Successfully initiated client!");
```

```csharp
Configuration configuration = new Configuration();
string clientId = System.Environment.GetEnvironmentVariable("SNAPTRADE_CLIENT_ID");
string consumerKey = System.Environment.GetEnvironmentVariable("SNAPTRADE_CONSUMER_KEY");
configuration.ApiKey.Add("clientId", clientId);
configuration.ConsumerKey = consumerKey;
apiStatusApi = new APIStatusApi(configuration);
authenticationApi = new AuthenticationApi(configuration);
accountInformationApi = new AccountInformationApi(configuration);
transactionsAndReportingApi = new TransactionsAndReportingApi(configuration);
referenceDataApi = new ReferenceDataApi(configuration);
optionsApi = new OptionsApi(configuration);
Console.WriteLine("Successfully initiated clients!");
```

:::

::button[Initialize SDK Client]

::::

## 2. Create a new user on SnapTrade

To create a secure brokerage connection, we first need to register a SnapTrade
user. Call the [Register
user](https://docs.snaptrade.com/reference/Authentication/Authentication_registerSnapTradeUser)
endpoint with a unique ID for an end user in your system.
Upon success, you should receive a system generated user secret.
You can think of the user secret like a per-user API key that provides an
additional layer of security for protecting user data. The user id and user
secret need to be passed along to all SnapTrade API endpoints that involve
access to user data.

:::form

::input{name=SNAPTRADE_USER_ID label="SnapTrade User ID" placeholder="YOUR_SNAPTRADE_USER_ID"}

```python
user_id = SNAPTRADE_USER_ID
register_response = snaptrade.authentication.register_snap_trade_user(
user_id=user_id
)
print(json.dumps(register_response.body, indent=2))

# Note: A user secret is only generated once. It's required to access
# resources for certain endpoints.

user_secret = register_response.body["userSecret"]
```

::button[Register User]

:::

## 3. Connect a brokerage account

Now that the user is created, we are ready to connect their brokerage accounts to SnapTrade. This is done via the SnapTrade Connection Portal. Each Connection Portal session is unique to the user and is generated by calling the [Generate Connection Portal URL](https://docs.snaptrade.com/reference/Authentication/Authentication_loginSnapTradeUser) endpoint passing in the user ID and user secret.

:::form

```python
redirect_uri = snaptrade.authentication.login_snap_trade_user(
user_id=user_id, user_secret=user_secret
)

print(json.dumps(redirect_uri.body, indent=2))
```

::button[Generate Connection Portal URL]

:::

From the response, open the redirect URL in a new browser tab to complete the connection, and close it after you're done.

If you don't have a live brokerage account to test with, you can create a Paper Trading account with [Alpaca](https://app.alpaca.markets/signup) and select "Alpaca Paper" as the instituion in the Connection Portal when prompted.


## 4. List connected accounts

Once the end user makes a successful connection, SnapTrade will retrieve all the brokerage accounts that the user has granted access to. You can use the [List Accounts](https://docs.snaptrade.com/reference/Account%20Information/AccountInformation_listUserAccounts) endpoints to retrieve all connected accounts. For each account, the `id` field uniquely identifies the account within SnapTrade and needs to be passed in for all subsequent account-related API calls.

:::form

```python
accounts = snaptrade.account_information.list_user_accounts(
    user_id=user_id,
    user_secret=user_secret
)
print(json.dumps(accounts.body, indent=2))

for account in accounts.body:
    print("::SAVE[ACCOUNTS]/{}".format(account["id"]))
```

::button[List User Accounts]

:::

## 5. Get account detail

The [Account Detail](https://docs.snaptrade.com/reference/Account%20Information/AccountInformation_getUserAccountDetails) endpoint gives you a detailed view of the account, including account number, name, total market value, and more.

Select a connected account below to retrieve the account detail.

:::form{skippable}

::enum{name=ACCOUNT_ID label="Account ID" placeholder="ACCOUNT ID" savedData=ACCOUNTS description="The SnapTrade account ID"}

```python
account_id = ACCOUNT_ID
account_detail = snaptrade.account_information.get_user_account_details(
    account_id=account_id, user_id=user_id, user_secret=user_secret
)
print(json.dumps(account_detail.body, indent=2))
```

::button[Get Account Detail]

:::

## 6. Get account positions

The [Account Positions](https://docs.snaptrade.com/reference/Account%20Information/AccountInformation_getUserAccountPositions) endpoint give you a list of stock/ETF/crypto/mutual fund positions in the account. 

:::form{skippable}

```python
positions = snaptrade.account_information.get_user_account_positions(
    account_id=account_id, user_id=user_id, user_secret=user_secret
)
print(json.dumps(positions.body, indent=2))
```

::button[Get Equity Positions]

:::

Option positions are currently returned via a separate [Options Positions](https://docs.snaptrade.com/reference/Options/Options_getUserAccountOptionPositions) endpoint.

:::form{skippable}

```python
option_positions = snaptrade.options.list_option_holdings(
    account_id=account_id, user_id=user_id, user_secret=user_secret
)
print(json.dumps(option_positions.body, indent=2))
```

::button[Get Option Positions]

:::

## 7. Deleting a user

You've reached the end of this demo! If you want to delete the user you created, you can do so by calling the [Delete User](https://docs.snaptrade.com/reference/Authentication/Authentication_deleteSnapTradeUser) endpoint. This will delete the user and all associated data (connections, accounts, positions, etc) permanently.

:::form

```python
deleted_response = snaptrade.authentication.delete_snap_trade_user(
user_id=user_id
)
print(json.dumps(deleted_response.body, indent=2))
```

::button[Delete User]

:::
